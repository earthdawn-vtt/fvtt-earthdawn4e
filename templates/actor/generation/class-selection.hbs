
<section class="tab {{tab.cssClass}} scrollable" data-group="primary" data-tab="class-tab">
 <!-- Class explainer -->
  <h4>{{localize "ED.Dialogs.CharGen.chooseClass"}}</h4>
  <p class="explainer-text">
    {{{localize "ED.Dialogs.CharGen.chooseClassRules"}}}
  </p>

  <!-- choose class type: discipline or questor -->
  <section class="discipline-questor-switch-group flexrow">
    <label class="discipline-questor-switch-group flexrow">
      <span class="{{#unless object.isAdept}}deselected-class-type{{/unless}}" id="char-gen-class-type-discipline-label">
        {{localize "ED.Dialogs.CharGen.discipline"}}
      </span>
      <input type="checkbox" name="isAdept" {{checked object.isAdept}} hidden="">
      {{#if object.isAdept}}
        <i id="char-gen-class-type-select-arrow" class="arrow-toggle-switch fas fa-duotone fa-arrow-left-from-line fa-xl"></i>
      {{else}}
        <i id="char-gen-class-type-select-arrow" class="arrow-toggle-switch fas fa-duotone fa-arrow-right-from-line fa-xl"></i>
      {{/if}}
      <span class="{{#if object.isAdept}}deselected-class-type{{/if}}" id="char-gen-class-type-questor-label">
        {{localize "ED.Dialogs.CharGen.questor"}}
      </span>
    </label>
  </section>

  <!-- Choose class -->
  <section class="available-disciplines-questors-choices flexrow">
    {{#if object.isAdept}}
      {{radioBoxes "selectedClass" disciplineRadioChoices checked=object.selectedClass}}
    {{else}}
      {{radioBoxes "selectedClass" questorRadioChoices checked=object.selectedClass}}
    {{/if}}
  </section>

  <!-- Abilities explainer -->
  <h4>{{localize "ED.Dialogs.CharGen.abilities"}}</h4>
  <p class="explainer-text">
    {{#if object.isAdept}}
      {{{localize "ED.Dialogs.CharGen.chooseTalentsRules"}}}
    {{else}}
      {{{localize "ED.Dialogs.CharGen.chooseDevotionRules"}}}
    {{/if}}
  </p>

  <!-- Rank assignment -->
  <section class="rank-assignment">

    <!-- Available Ranks Indicator -->
    <div class="availability-meter available-talent-ranks flexrow">
      <button class="reset-points" id="char-gen-clear-talent-ranks-button" type="button"
              title="{{localize "ED.Dialogs.ToolTips.resetAbilityRanks"}}" data-action="reset" data-reset-type="classAbilities">
        <i class="fa-light fa-arrows-rotate"></i>
        {{localize "ED.Dialogs.CharGen.Buttons.resetRanks"}}
      </button>
      <label>{{localize "ED.Dialogs.CharGen.availableRanks"}}: {{lookup object.availableRanks (ifThen object.isAdept "talent" "devotion" )}}{{!--format "X.availablePointsKarma" points=... --}}</label>
      <meter value="{{lookup object.availableRanks (ifThen object.isAdept "talent" "devotion" )}}" min="0" max="{{lookup config.availableRanks (ifThen object.isAdept "talent" "devotion" )}}">
      </meter>
    </div>
  </section>

  <!-- Ability selection -->
  <div class="talent-tables flexrow">

    <!-- Optional Abilities -->
    <table class="optional-talents-pool">
      <colgroup>
        <col />
      </colgroup>
      <tr>
        {{#if object.isAdept}}
          <th colspan="2">{{localize "ED.Dialogs.CharGen.optionalTalents"}}</th>
        {{else}}
          <th colspan="2">{{localize "ED.Dialogs.CharGen.optionalDevotions"}}</th>
        {{/if}}
      </tr>
      {{#each classDocument.system.advancement.abilityOptions.novice}}
        <tr class="flexrow">
          <td class=" ability-name" data-ability-uuid="{{this}}">
            <label for="char-gen-ability-option-radio">
              <input type="radio" id="char-gen-ability-option-radio" name="abilityOption" value="{{this}}" {{checked (ed-hasOwnProperty @root.object.abilities.optional this)}}>
              {{ed-nameFromUuid this}}
            </label>
          </td>
          <td class="flexrow rank-change">
            {{#if (ed-hasOwnProperty @root.object.abilities.optional this)}}
              <span class="decrease-value-button rank-decrease rank-change-icon" title="{{localize 'X.Decrease Rank Value'}}"
                    data-change-type="decrease" data-action="decreaseAbility" data-ability-uuid="{{this}}" data-ability-type="optional">
              <i class="fa-light fa-circle-minus"></i>
            </span>
              <span class="rank-change-value">
                {{lookup @root.object.abilities.optional this}}
              </span>
              <span class="increase-value-button rank-increase rank-change-icon" title="{{localize 'X.Increase Rank Value'}}"
                    data-change-type="increase" data-action="increaseAbility" data-ability-uuid="{{this}}" data-ability-type="optional">
              <i class="fa-light fa-circle-plus"></i>
            </span>
            {{/if}}
          </td>
        </tr>
      {{/each}}
    </table>

    <!-- Class Abilities -->
    <table class="class-talents-pool">
      <colgroup>
        <col span="2"/>
      </colgroup>
      <tr>
        {{#if object.isAdept}}
          <th colspan="2">{{localize "ED.Dialogs.CharGen.disciplineTalents" classType=classDocument.type}}</th>
        {{else}}
          <th colspan="2">{{localize "ED.Dialogs.CharGen.questorDevotion" classType=classDocument.type}}</th>
        {{/if}}     
      </tr>
      {{#each classDocument.system.advancement.levels.0.abilities}}
        {{#if (ed-hasItems this)}}
          <th colspan="2">{{lookup @root.config.abilityPools @key}}</th>
        {{/if}}
        {{#each this}}
          <tr class="flexrow">
            <td class="ability-name" data-ability-uuid="{{this}}">
              {{ed-nameFromUuid this}}
            </td>
            {{#if (eq @../key "class")}}
              <td class="flexrow rank-change">
              <span class="decrease-value-button rank-decrease rank-change-icon" title="{{localize "ED.Dialogs.CharGen.ToolTips.decreaseRankValue"}}"
                    data-change-type="decrease" data-action="decreaseAbility" data-ability-uuid="{{this}}" data-ability-type="{{@../key}}">
                <i class="fa-light fa-circle-minus"></i>
              </span>
                <span class="rank-change-value">
                  {{lookup @root.object.abilities.class this}}
                </span>
                <span class="increase-value-button rank-increase rank-change-icon" title="{{localize "ED.Dialogs.CharGen.ToolTips.increaseRankValue"}}"
                      data-change-type="increase" data-action="increaseAbility" data-ability-uuid="{{this}}" data-ability-type="{{@../key}}">
                <i class="fa-light fa-circle-plus"></i>
              </span>
              </td>
            {{/if}}
          </tr>
        {{/each}}
      {{/each}}
    </table>
  </div>

</section>