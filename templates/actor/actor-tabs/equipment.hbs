<section class="tab {{tabs.equipment.cssClass}}" data-group="sheet" data-tab="equipment">
<h3>{{localize "ED.Actor.Header.equipment"}}</h3>
<div class="container__block">
 {{#if (eq this.actor.type "character")}}
    <div class="encumbrance-wrapper">
        <div class="encumbrance-row">
            <span class="encumbrance-label">{{localize "ED.Actor.Header.encumbrance"}}:</span>
            <div>
            <input id="meter-value" class="input__number-input" type="number" name="system.encumbrance.value"
                value="{{actor.system.encumbrance.value}}" min="0" step="1" oninput="
                const wrapper = this.closest('.encumbrance-wrapper');
                const fill = wrapper.querySelector('.encumbrance-fill');
                const max = parseFloat(wrapper.querySelector('#max-value').value);
                const val = parseFloat(this.value);
                const rangeMax = max * 2;
                const percent = (val / rangeMax) * 100;
                fill.style.setProperty('--fill-width', percent + '%');
                fill.classList.remove('low', 'medium', 'high', 'over');
                if (val <= max) {
                    fill.classList.add('low');
                } else if (val <= max * 1.5) {
                    fill.classList.add('medium');
                } else if (val <= rangeMax) {
                    fill.classList.add('high');
                } else {
                    fill.classList.add('over');
                }
                ">
            </div>
            <span>/</span>
            <div>
            <input id="max-value" class="input__number-input" type="number" name="system.encumbrance.max"
                value="{{actor.system.encumbrance.max}}" min="1" step="1" oninput="
                document.getElementById('meter-value').dispatchEvent(new Event('input'));
                ">
            </div>
            <div class="encumbrance-bar">
            <div class="encumbrance-fill"></div>
            <div class="encumbrance-marker marker-x"></div>
            <div class="encumbrance-marker marker-x15"></div>
            </div>
        </div>
    </div>
    {{/if}}
    {{!-- Weapons --}}
    <div class="equipment-card__grid--container container__header text-break__auto">
        <div class="equipment-card__grid--item"></div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.weapons"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.damage"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.range"}}</div>
        {{#if (eq system.weaponType "thrown")}}
            <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.ammunition"}}</div>
        {{else}}
            <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.amount"}}</div>
        {{/if}}
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.equippedStatus"}}</div>
        <div class="equipment-card__grid--item"></div>
    </div>
    {{#each actor.itemTypes.weapon}}
        {{> "systems/ed4e/templates/actor/cards/equipment-card.hbs"}}
    {{/each}}

    {{!-- Armor --}}
    <div class="equipment-card__grid--container container__header text-break__auto">
        <div class="equipment-card__grid--item"></div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.armor"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.physicalArmor"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.mysticalArmor"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.initiativePenalty"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.equippedStatus"}}</div>
        <div class="equipment-card__grid--item"></div>
    </div>

    {{#each actor.itemTypes.armor}}
        {{> "systems/ed4e/templates/actor/cards/equipment-card.hbs"}}
    {{/each}}

    {{!-- Shields --}}
    <div class="equipment-card__grid--container container__header text-break__auto">
        <div class="equipment-card__grid--item"></div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.shields"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.physicalDefense"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.mysticalDefense"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.initiativePenalty"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.equippedStatus"}}</div>
        <div class="equipment-card__grid--item"></div>
    </div>
    {{#each actor.itemTypes.shield}}
        {{> "systems/ed4e/templates/actor/cards/equipment-card.hbs"}}
    {{/each}}

    {{!-- EQUIPMENTS --}}
    <div class="equipment-card__grid--container container__header text-break__auto">
        <div class="equipment-card__grid--item"></div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.equipment"}}</div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.amount"}}</div>
        <div class="equipment-card__grid--item"></div>
        <div class="equipment-card__grid--item"></div>
        <div class="equipment-card__grid--item">{{localize "ED.Actor.Header.equippedStatus"}}</div>
        <div class="equipment-card__grid--item"></div>
    </div>
    {{#each actor.itemTypes.equipment}}
        {{> "systems/ed4e/templates/actor/cards/equipment-card.hbs"}}
    {{/each}}

<div>
</section>